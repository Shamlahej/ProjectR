<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="ProjectR.MainWindow"
        Width="920"
        Height="680"
        Title="ProjectR - Sorting Robot Arm">
<Window.Styles>
  <!-- ==== FARVER (lokalt i MainWindow) ==== -->
  <Style>
    <Style.Resources>
      <!-- Backgrounds -->
      <SolidColorBrush x:Key="Bg" Color="#0F172A"/>
      <SolidColorBrush x:Key="Card" Color="#111C34"/>
      <SolidColorBrush x:Key="Card2" Color="#0B1224"/>
      <SolidColorBrush x:Key="Border" Color="#24314F"/>
      <SolidColorBrush x:Key="Text" Color="#E5E7EB"/>
      <SolidColorBrush x:Key="Muted" Color="#94A3B8"/>

      <!-- Buttons -->
      <SolidColorBrush x:Key="Btn" Color="#1F2A44"/>
      <SolidColorBrush x:Key="BtnHover" Color="#24314F"/>
      <SolidColorBrush x:Key="Danger" Color="#DC2626"/>
      <SolidColorBrush x:Key="DangerHover" Color="#B91C1C"/>
    </Style.Resources>
  </Style>

  <!-- Standard tekst -->
  <Style Selector="TextBlock">
    <Setter Property="Foreground" Value="{DynamicResource Text}"/>
  </Style>

  <!-- Standard TextBox -->
  <Style Selector="TextBox">
    <Setter Property="Background" Value="{DynamicResource Card2}"/>
    <Setter Property="Foreground" Value="{DynamicResource Text}"/>
    <Setter Property="BorderBrush" Value="{DynamicResource Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="CornerRadius" Value="10"/>
    <Setter Property="Padding" Value="10,8"/>
  </Style>

  <!-- Standard Button -->
  <Style Selector="Button">
    <Setter Property="Background" Value="{DynamicResource Btn}"/>
    <Setter Property="Foreground" Value="{DynamicResource Text}"/>
    <Setter Property="BorderBrush" Value="{DynamicResource Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="CornerRadius" Value="10"/>
    <Setter Property="Padding" Value="12,8"/>
  </Style>
  <Style Selector="Button:pointerover">
    <Setter Property="Background" Value="{DynamicResource BtnHover}"/>
  </Style>

  <!-- Baggrund/kort via Name selectors -->
  <Style Selector="Border#RootBackground">
    <Setter Property="Background" Value="{DynamicResource Bg}"/>
  </Style>

  <Style Selector="Border#MainCard">
    <Setter Property="Background" Value="{DynamicResource Card}"/>
    <Setter Property="BorderBrush" Value="{DynamicResource Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
  </Style>

  <Style Selector="Border#BottomCard">
    <Setter Property="Background" Value="{DynamicResource Card}"/>
    <Setter Property="BorderBrush" Value="{DynamicResource Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
  </Style>

  <Style Selector="Border#TopBarCard">
    <Setter Property="Background" Value="{DynamicResource Card}"/>
    <Setter Property="BorderBrush" Value="{DynamicResource Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
  </Style>

  <Style Selector="Border#CountersPanel">
    <Setter Property="Background" Value="{DynamicResource Card2}"/>
    <Setter Property="BorderBrush" Value="{DynamicResource Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
  </Style>

  <Style Selector="Border#StatusPanel">
    <Setter Property="Background" Value="{DynamicResource Card2}"/>
    <Setter Property="BorderBrush" Value="{DynamicResource Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
  </Style>

  <Style Selector="Border#EmergencyPanel">
    <Setter Property="Background" Value="{DynamicResource Card2}"/>
    <Setter Property="BorderBrush" Value="{DynamicResource Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
  </Style>

  <!-- Emergency knap -->
  <Style Selector="Button#EmergencyButton">
    <Setter Property="Background" Value="{DynamicResource Danger}"/>
    <Setter Property="BorderBrush" Value="{DynamicResource DangerHover}"/>
  </Style>
  <Style Selector="Button#EmergencyButton:pointerover">
    <Setter Property="Background" Value="{DynamicResource DangerHover}"/>
  </Style>

  <!-- Hint tekster -->
  <Style Selector="TextBlock#StatusHintText">
    <Setter Property="Foreground" Value="{DynamicResource Muted}"/>
  </Style>
  <Style Selector="TextBlock#ConveyorStatusText">
    <Setter Property="Foreground" Value="{DynamicResource Muted}"/>
  </Style>
</Window.Styles>

    <Grid RowDefinitions="Auto,*,Auto">

        <!-- TABS -->
        <TabControl Name="TabControl" Grid.Row="0">

            <!-- LOGIN -->
            <TabItem Header="ðŸ”‘ Login" Name="LoginTab">
                <StackPanel Margin="12" Spacing="8">
                    <TextBox Name="LoginUsername" Watermark="username" Text="admin"/>
                    <TextBox Name="LoginPassword" Watermark="password" PasswordChar="â—" Text="admin"/>
                    <Button Click="LoginButton_OnClick">Login</Button>
                </StackPanel>
            </TabItem>

            <!-- ROBOT (DIT DESIGN + plads til IP/Connect Ã¸verst) -->
            <TabItem Header="ðŸ¦¾ Robot" Name="RobotTab">

                <Border Name="RootBackground">
                    <Grid Margin="24">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- HEADER -->
                        <StackPanel Grid.Row="0" Spacing="6" HorizontalAlignment="Center">
                            <TextBlock Text="Sorting Robot Arm"
                                       FontSize="28"
                                       FontWeight="Bold"/>
                            <TextBlock Text="Standalone HMI (simulation)"
                                       FontSize="14"
                                       Opacity="0.7"/>
                        </StackPanel>

                        <!-- TOPBAR: IP + CONNECT + SEND -->
                        <Border Grid.Row="1"
                                Name="TopBarCard"
                                Margin="0,18,0,0"
                                CornerRadius="14"
                                Padding="14">
                            <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                                <TextBlock VerticalAlignment="Center" Text="Robot IP:"/>
                                <TextBox Name="IpAddress" Width="220" Text="172.20.254.207"/>

                                <Button Click="ConnectButton_OnClick"
                                        Width="140"
                                        Height="38"
                                        CornerRadius="8"
                                        Content="Connect"/>

                                <Button Click="SendScriptButton_OnClick"
                                        Width="170"
                                        Height="38"
                                        CornerRadius="8"
                                        Content="Send robot.script"/>
                            </StackPanel>
                        </Border>

                        <!-- MAIN -->
                        <Border Grid.Row="2"
                                Name="MainCard"
                                Margin="0,20,0,0"
                                CornerRadius="14"
                                Padding="22">

                            <Grid ColumnDefinitions="*,*"
                                  RowDefinitions="Auto,Auto"
                                  ColumnSpacing="22"
                                  RowSpacing="18">

                                <!-- LEFT: CONTROL -->
                                <StackPanel Grid.Row="0" Grid.Column="0" Grid.RowSpan="2" Spacing="16">
                                    <TextBlock Text="Control"
                                               FontSize="18"
                                               FontWeight="Bold"/>

                                    <StackPanel Orientation="Horizontal" Spacing="12">
                                        <Button Name="StartButton"
                                                Content="Start Sorting"
                                                Width="170"
                                                Height="44"
                                                CornerRadius="8"
                                                Click="StartButton_OnClick"/>

                                        <Button Name="StopButton"
                                                Content="Stop Sorting"
                                                Width="170"
                                                Height="44"
                                                CornerRadius="8"
                                                IsEnabled="False"
                                                Click="StopButton_OnClick"/>
                                    </StackPanel>

                                    <!-- Reset -->
                                    <Button Name="ResetButton"
                                            Content="Reset Counter"
                                            Width="170"
                                            Height="40"
                                            CornerRadius="8"
                                            Click="ResetButton_OnClick"/>

                                    <!-- Emergency -->
                                    <Border Name="EmergencyPanel"
                                            BorderThickness="1"
                                            CornerRadius="12"
                                            Padding="14">
                                        <StackPanel Spacing="10">
                                            <TextBlock Name="EmergencyTitle"
                                                       Text="Emergency"
                                                       FontSize="16"
                                                       FontWeight="Bold"/>
                                            <TextBlock Text="Stops sorting and conveyor"
                                                       Opacity="0.8"/>
                                            <Button Name="EmergencyButton"
                                                    Content="EMERGENCY STOP"
                                                    Height="54"
                                                    FontSize="16"
                                                    FontWeight="Bold"
                                                    CornerRadius="10"
                                                    Click="EmergencyButton_OnClick"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>

                                <!-- RIGHT TOP: COUNTER -->
                                <Border Name="CountersPanel"
                                        Grid.Row="0" Grid.Column="1"
                                        CornerRadius="12"
                                        Padding="14">
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="CORRECT SORTED"
                                                   FontSize="18"
                                                   FontWeight="Bold"/>
                                        <TextBox Name="CorrectCounterBox"
                                                 Text="0"
                                                 IsReadOnly="True"
                                                 Width="240"
                                                 Height="64"
                                                 FontSize="32"
                                                 FontWeight="Bold"
                                                 HorizontalContentAlignment="Center"/>
                                    </StackPanel>
                                </Border>

                                <!-- RIGHT BOTTOM: STATUS + CONVEYOR -->
                                <Border Name="StatusPanel"
                                        Grid.Row="1" Grid.Column="1"
                                        CornerRadius="12"
                                        Padding="14">
                                    <StackPanel Spacing="10">
                                        <TextBlock Text="Status"
                                                   FontWeight="Bold"/>
                                        <TextBlock Name="StatusText"
                                                   Text="Ready"
                                                   FontSize="16"
                                                   FontWeight="Bold"/>
                                        <TextBlock Name="StatusHintText"
                                                   Text="Waiting"
                                                   Opacity="0.7"/>

                                        <Separator/>

                                        <TextBlock Text="Conveyor"
                                                   FontWeight="Bold"/>
                                        <TextBlock Name="ConveyorStatusText"
                                                   Text="Stopped"
                                                   FontWeight="Bold"/>
                                        <Button Name="ConveyorButton"
                                                Content="Start Conveyor"
                                                Width="240"
                                                Height="44"
                                                CornerRadius="8"
                                                Click="ConveyorButton_OnClick"/>
                                    </StackPanel>
                                </Border>

                            </Grid>
                        </Border>

                        <!-- LOG (din robot-log) -->
                        <Border Grid.Row="3"
                                Name="BottomCard"
                                Margin="0,18,0,0"
                                CornerRadius="14"
                                Padding="16">
                            <StackPanel Spacing="8">
                                <TextBlock Text="Log"
                                           FontSize="16"
                                           FontWeight="Bold"/>
                                <TextBox Name="LogBox"
                                         Height="140"
                                         AcceptsReturn="True"
                                         IsReadOnly="True"
                                         FontFamily="Consolas"
                                         FontSize="12"/>
                            </StackPanel>
                        </Border>

                    </Grid>
                </Border>

            </TabItem>

            <!-- USERS -->
            <TabItem Header="ðŸ‘¥ Users" Name="UsersTab">
                <StackPanel Margin="12" Spacing="8">
                    <TextBlock FontWeight="Bold" Text="Create User"/>
                    <TextBox Name="CreateUserUsername" Watermark="username"/>
                    <TextBox Name="CreateUserPassword" Watermark="password" PasswordChar="â—"/>
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock VerticalAlignment="Center" Text="Is admin"/>
                        <CheckBox Name="CreateUserIsAdmin"/>
                    </StackPanel>
                    <Button Click="CreateUserButton_OnClick">Register</Button>
                </StackPanel>
            </TabItem>

            <!-- DATABASE -->
            <TabItem Header="ðŸ›¢ Database" Name="DatabaseTab">
                <StackPanel Margin="12" Spacing="8">
                    <Button Click="RecreateDatabaseButton_OnClick">Recreate database</Button>
                    <Button Click="ShowCounter_OnClick">Show counter</Button>
                </StackPanel>
            </TabItem>

        </TabControl>

        <!-- APP LOG (mÃ¸rk som resten) -->
        <Border Grid.Row="1"
                Background="{DynamicResource Card}"
                BorderBrush="{DynamicResource Border}"
                BorderThickness="1"
                CornerRadius="14"
                Padding="12"
                Margin="24,0,24,0">

            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <TextBlock Name="LogOutput"
                           TextWrapping="Wrap"
                           FontFamily="Consolas"
                           Foreground="{DynamicResource Text}"/>
            </ScrollViewer>

        </Border>


        <Grid Grid.Row="2" ColumnDefinitions="*,Auto">
            <Button Grid.Column="0" Click="ClearLogButton_OnClick">Clear</Button>
            <Button Grid.Column="1" Name="LogoutButton" IsVisible="False" Click="LogoutButton_OnClick" Margin="8,0,0,0">
                Logout
            </Button>
        </Grid>

    </Grid>
</Window>
